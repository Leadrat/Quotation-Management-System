openapi: 3.0.3
info:
  title: CRM API - User Registration
  version: '1.0.0'
servers:
  - url: https://api.example.com
paths:
  /api/v1/auth/register:
    post:
      summary: Client self-registration
      tags: [Auth]
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, firstName, lastName]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 8
                firstName:
                  type: string
                lastName:
                  type: string
                mobile:
                  type: string
                phoneCode:
                  type: string
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  userId:
                    type: string
                    format: uuid
                  email:
                    type: string
                  redirectUrl:
                    type: string
        '400':
          description: Validation error
        '409':
          description: Email already exists
  /api/v1/users:
    post:
      summary: Admin create user
      tags: [Users]
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required: [email, password, firstName, lastName, roleId]
              properties:
                email:
                  type: string
                  format: email
                password:
                  type: string
                  minLength: 8
                firstName:
                  type: string
                lastName:
                  type: string
                mobile:
                  type: string
                phoneCode:
                  type: string
                roleId:
                  type: string
                  format: uuid
                reportingManagerId:
                  type: string
                  format: uuid
      responses:
        '201':
          description: Created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  user:
                    $ref: '#/components/schemas/UserDto'
                  emailSent:
                    type: boolean
                  temporaryPasswordExpiry:
                    type: string
                    format: date-time
        '400': { description: Validation error }
        '401': { description: Unauthorized }
        '403': { description: Forbidden }
        '409': { description: Email already exists }
        '422': { description: Role/Manager validation error }
components:
  securitySchemes:
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT
  schemas:
    UserDto:
      type: object
      properties:
        userId:
          type: string
          format: uuid
        email:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        mobile:
          type: string
        phoneCode:
          type: string
        isActive:
          type: boolean
        roleId:
          type: string
          format: uuid
        roleName:
          type: string
        reportingManagerId:
          type: string
          format: uuid
        reportingManagerName:
          type: string
        lastLoginAt:
          type: string
          format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
